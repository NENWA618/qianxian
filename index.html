<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#e8dfc8">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="千弦">
  <title>千弦家族官方网站</title>
  
  <!-- 预加载关键资源 -->
  <link rel="preload" href="main.css" as="style">
  <link rel="preload" href="https://qianxian-backend.onrender.com/api/site-content" as="fetch" crossorigin="use-credentials">
  <link rel="preload" href="https://cdn.socket.io/4.7.5/socket.io.min.js" as="script">
  
  <!-- 资源链接 -->
  <link rel="icon" href="qianxian.png" type="image/png">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="qianxian.png">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <!-- 加载指示器 -->
  <div id="loading-indicator" aria-hidden="true">
    <div class="spinner" aria-label="加载中"></div>
  </div>

  <!-- 头部区域 -->
  <header class="logo-header">
    <img src="qianxian.png" alt="千弦 Logo" class="logo" loading="lazy" width="160" height="160">
    <h1><a href="index.html" aria-current="page">千弦</a></h1>
    <nav class="main-nav" aria-label="主导航">
      <a href="members.html">成员列表</a>
      <span id="auth-status"></span>
    </nav>
  </header>

  <!-- 主要内容 -->
  <main>
    <section class="about" id="about-section" aria-labelledby="about-heading">
      <h2 id="about-heading" class="sr-only">关于千弦</h2>
      <div class="content-placeholder">
        <p>加载家族介绍中...</p>
      </div>
    </section>

    <section class="announcement" id="announcement-section" aria-labelledby="announcement-heading">
      <h2 id="announcement-heading" class="sr-only">家族公告</h2>
      <div class="content-placeholder">
        <p>加载最新公告中...</p>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer>
    <p>© <span id="current-year"></span> 千弦家族 · 保留所有权利</p>
    <p id="online-count">在线人数: 加载中...</p>
  </footer>

  <!-- 脚本加载 -->
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" 
          integrity="sha384-2huaZvOR9iDzHqsl6wpS5a6X4O7A4O5q5J5j5E5J5j5E5J5j5E5J5j5E5J5j5E5J" 
          crossorigin="anonymous"
          defer></script>
  <script src="main.js" defer></script>

  <!-- 内联初始化脚本 -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // 设置当前年份
      document.getElementById('current-year').textContent = new Date().getFullYear();
      
      // 显示加载状态
      const loadingIndicator = document.getElementById('loading-indicator');
      loadingIndicator.style.display = 'flex';
      
      // 检查用户认证状态
      checkAuth().finally(() => {
        loadingIndicator.style.display = 'none';
      });
    });
  </script>
</body>
</html>